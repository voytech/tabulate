<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.16">
<meta name="author" content="by">
<title>Tabulate</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/*! Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment the following line when using as a custom stylesheet */
/* @import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700"; */
html{font-family:sans-serif;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
b,strong{font-weight:bold}
abbr{font-size:.9em}
abbr[title]{cursor:help;border-bottom:1px dotted #dddddf;text-decoration:none}
dfn{font-style:italic}
hr{height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type=checkbox],input[type=radio]{padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,::before,::after{box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;line-height:1;position:relative;cursor:auto;-moz-tab-size:4;-o-tab-size:4;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:1px solid #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;border-radius:3px;box-shadow:0 1px 0 rgba(0,0,0,.2),inset 0 0 0 .1em #fff;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin:0 auto;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:flex;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border:1px solid #e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:hsla(0,0%,100%,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details{margin-left:1.25rem}
details>summary{cursor:pointer;display:block;position:relative;line-height:1.6;margin-bottom:.625rem;-webkit-tap-highlight-color:transparent}
details>summary::before{content:"";border:solid transparent;border-left:solid;border-width:.3em 0 .3em .5em;position:absolute;top:.5em;left:-1.25rem;transform:translateX(15%)}
details[open]>summary::before{border:solid transparent;border-top:solid;border-width:.5em .3em 0;transform:translateY(15%)}
details>summary::after{content:"";width:1.25rem;height:1em;position:absolute;top:.3em;left:-1.25rem}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class=paragraph]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border:1px solid #e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border:1px solid #dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class=highlight],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans-serif;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist>li>p:first-child{margin-left:-1em}
ul.checklist>li>p:first-child>.fa-square-o:first-child,ul.checklist>li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist>li>p:first-child>input[type=checkbox]:first-child{margin-right:.25em}
ul.inline{display:flex;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:4px solid #fff;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt,summary{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt,summary{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]{border-bottom:1px dotted}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media amzn-kf8,print{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body class="article">
<div id="header">
<h1>Tabulate</h1>
<div class="details">
<span id="author" class="author">by</span><br>
<span id="email" class="email"><a href="mailto:wojmak@gmail.com">wojmak@gmail.com</a></span><br>
</div>
<div id="toc" class="toc">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_introduction">Introduction</a></li>
<li><a href="#_key_concepts">Key concepts</a>
<ul class="sectlevel2">
<li><a href="#_table_model">Table model.</a></li>
<li><a href="#_table_dsl_api_type_safe_builders">Table DSL API - type-safe builders.</a></li>
<li><a href="#column_bound_cell_value_extractors">Column bound cell value extractors.</a></li>
<li><a href="#row_predicates">Row predicates.</a></li>
</ul>
</li>
<li><a href="#_extension_points">Extension points.</a>
<ul class="sectlevel2">
<li><a href="#_implementing_new_table_export_operations">Implementing new table export operations.</a></li>
<li><a href="#_registering_new_attribute_types_for_existing_export_operations">Registering new attribute types for existing export operations.</a></li>
<li><a href="#_extending_table_dsl_api">Extending Table DSL API</a></li>
</ul>
</li>
<li><a href="#_other_features">Other features</a>
<ul class="sectlevel2">
<li><a href="#_java_interop_fluent_builders_java_api">Java interop - fluent builders Java API.</a></li>
<li><a href="#_custom_rows">Custom rows.</a></li>
<li><a href="#_merging_rows">Merging rows.</a></li>
<li><a href="#_library_of_attributes">Library of attributes.</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div style="page-break-after: always;"></div>
</div>
</div>
<div class="sect1">
<h2 id="_introduction">Introduction</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Exporting data to external file formats can be tedious and cumbersome - especially when business wants to have reports covering vast majority of system functionalities. Writing every exporting method using imperative API directly will soon make code verbose, error prone, hard to read and maintain. In such cases You want to hide implementation details using abstractions, but this is additional effort which is not desirable.</p>
</div>
<div class="paragraph">
<p><code>Tabulate</code> tries to mitigate above problems with the help of <code>Kotlin</code>, its <code>type-safe DSL builders</code> and <code>extension functions</code>.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_key_concepts">Key concepts</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_table_model">Table model.</h3>
<div class="paragraph">
<p>Table model defines how table will look like after data exporting. Its building blocks are:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>column</code> - defines a single column in table,</p>
</li>
<li>
<p><code>row</code>  - may be user defined custom row or row that carries attributes for enriching existing record,</p>
</li>
<li>
<p><code>row cell</code> - defines cell within row. Cell is bound to a column via column id,</p>
</li>
<li>
<p><code>attribute</code> - introduces extensions to basic presentation capabilities.</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Table model is internal concept and is not exposed to API consumers (Only attribute model can be exposed as it is fully customisable). Table is always constructed using table builders as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">productList.tabulate(&quot;file.xlsx&quot;) {
    name = &quot;Table id&quot; <i class="conum" data-value="1"></i><b>(1)</b>
    columns {   <i class="conum" data-value="2"></i><b>(2)</b>
        column(&quot;nr&quot;)
    }
    rows { <i class="conum" data-value="3"></i><b>(3)</b>
        row {  // first row when no index provided.
            cell(&quot;nr&quot;) { value = &quot;Nr.:&quot; } <i class="conum" data-value="4"></i><b>(4)</b>
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Firstly we give the table name. It can be used by exporter e.g. to add metadata like sheet name.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Secondly we can provide column definitions. Column definition can be used to aggregate <code>ColumnAttributes</code> as well as <code>CellAttributes</code>. All attributes associated with particular column will apply to each cell in that column. Specifying column can also help to make table layout more readable.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Next step is to define table rows. Here we can create additional custom rows (like header or footer) or enhance table look and feel with attributes associated with particular row.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Each row can contain as many cells as many columns exist. Similarily to <code>row</code>, <code>cell</code> may be used to associate cell attributes with selected cell within row. You can also create cell with custom predefined or computed value.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>Above, we have created table definition with single column and one row with single cell.
Cell binds to column by column identifier which in our case is represented by simple text id "nr".</p>
</div>
<div class="paragraph">
<p>This is very basic example. In order to gain more powers You will need to start using <code>attributes</code>.</p>
</div>
<div class="paragraph">
<p><code>Attributes</code> are plain objects with inner properties that extends base model. Attributes can be mounted on multiple levels: <em>table</em>, <em>column</em>, <em>row</em> and single <em>cell</em> levels.</p>
</div>
<div class="paragraph">
<p>Example with attributes included:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">productList.tabulate(&quot;file.xlsx&quot;) {
    name = &quot;Table id&quot;
    attributes {
      filterAndSort {} <i class="conum" data-value="1"></i><b>(1)</b>
    }
    columns {
        column(&quot;nr&quot;) {
            attributes { width { px = 40 }} <i class="conum" data-value="2"></i><b>(2)</b>
        }
        column(Product::code) {
            attributes { width { auto = true}}
            attributes {
                text {
                    weight = DefaultWeightStyle.BOLD <i class="conum" data-value="3"></i><b>(3)</b>
                }
            }
        }
    }
    rows {
        row {  // first row when no explicit index provided.
              cell(&quot;nr&quot;) {
                value = &quot;Nr.:&quot;
                attributes {
                  text { <i class="conum" data-value="4"></i><b>(4)</b>
                    fontFamily = &quot;Times New Roman&quot;
                    fontColor = Colors.BLACK
                    fontSize = 12
                  }
                  background { color = Colors.BLUE }
                }
              }
        }
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Top level table attribute <code>TableAttribute</code> applicable only for excel file format</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Column level <code>ColumnAttribute</code> that defines width of entire column</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Column level <code>CellAttribute</code> - an attribute applicable for every cell in particular column.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Cell level attribute. This is the lowest level. Only <code>CellAttribute</code> can be used on that level.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_table_dsl_api_type_safe_builders">Table DSL API - type-safe builders.</h3>
<div class="paragraph">
<p>Kotlin type-safe builders fits well into describing table structure. It makes source code look more concise and readable and makes dev tasks much easier. At coding time, your IDE makes use of type-safety offered by builders and shows completion hints which elevates developer experience. Almost zero documentation is required to start. You can start playing with the API right now.</p>
</div>
<div class="paragraph">
<p>DSL functions by convention take <code>lambda with receivers</code> as arguments which abstract away internal API instantiation details from consumers. Within lambda you can call other API methods which in turn, can take downstream builders as arguments. This way - we can end up having multi-level DSL API structure, where each level is extensible via Kotlin extension functions. On each DSL level You are allowed to invoke receiver scope methods and access lexical scope variables which can lead to interesting results:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">    val additionalProducts = ... <i class="conum" data-value="1"></i><b>(1)</b>
    tabulate {
          name = &quot;Products table&quot;
          attributes {
            template { fileName = &quot;src/test/resources/template.xlsx&quot; } <i class="conum" data-value="2"></i><b>(2)</b>
          }
          rows {
              header(&quot;Code&quot;, &quot;Name&quot;, &quot;Description&quot;, &quot;Manufacturer&quot;) <i class="conum" data-value="3"></i><b>(3)</b>
              additionalProducts.forEach { <i class="conum" data-value="4"></i><b>(4)</b>
                  row {
                      cell { value = it.code }
                      cell { value = it.name }
                      cell { value = it.description }
                      cell { value = it.manufacturer }
                  }
              }
          }
    }.export(&quot;products.xlsx&quot;)</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Here we are using <code>additionalProducts</code> val which is collection of elements to be exported.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Then we are specifying a template file on which interpolation should take place.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>After that, we define header as long as we know that our template doesn&#8217;t mention it.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Finally, we are iterating over collection elements to build static table model.</td>
</tr>
</table>
</div>
<div class="admonitionblock caution">
<table>
<tr>
<td class="icon">
<i class="fa icon-caution" title="Caution"></i>
</td>
<td class="content">
Although it is possible to build row definitions by iterating over collection directly, you should always prefer to use <a href="#column_bound_cell_value_extractors">Column bound cell value extractors.</a>. They are much faster and consume much less memory than approach shown in point number <code>4</code>.
</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>As already said, it is possible to extend each DSL level by using extension functions on DSL API builder classes.</p>
</div>
<div class="paragraph">
<p>Take the example from previous section:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">    tabulate {
          rows {
              header(&quot;Code&quot;, &quot;Name&quot;, &quot;Description&quot;, &quot;Manufacturer&quot;)
          }
    }.export(&quot;products.xlsx&quot;)</code></pre>
</div>
</div>
<div class="paragraph">
<p>Function <code>.header</code> is implemented as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun &lt;T&gt; RowsBuilderApi&lt;T&gt;.header(vararg names: String) =
    newRow(0) { <i class="conum" data-value="1"></i><b>(1)</b>
        cells {
            names.forEach {
                cell { value = it }
            }
        }
    }</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Calling <code>.newRow(0)</code> <code>RowsBuilderApi</code> method internally ensures that <code>.header</code> extension function always defines custom row at index <code>0</code>.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>This way you can create various shortcuts and templates, making DSL vocabulary richer and more expressive.
It is worth mentioning that by using extension functions on DSL builders - scope becomes restricted by <code>DslMarker</code> annotation, so it is not possible to break table definition by calling methods from upstream builders.</p>
</div>
</div>
<div class="sect2">
<h3 id="column_bound_cell_value_extractors">Column bound cell value extractors.</h3>
<div class="paragraph">
<p>Column API makes it possible to pass property getter reference as a column key.
This creates object property to column binding which is applied later at run time for cell value evaluation.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">productsRepository.loadProductsByDate(now()).tabulate(&quot;file/path/products.xlsx&quot;) {
            name = &quot;Products table&quot;
            columns {
                column(Product::code)
                column(Product::name)
                column(Product::description)
            }
        }</code></pre>
</div>
</div>
<div class="paragraph">
<p>Property getter as column key kills two birds with one stone:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>It allows to reference column later in cell builder,</p>
</li>
<li>
<p>it allows to extract collection element property value when row context is built for rendering.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="row_predicates">Row predicates.</h3>
<div class="paragraph">
<p>You have already seen how <code>.header</code> extension function is implemented. Internally it invokes <code>.newRow(0)</code> which requests rendering of a row at index <code>0</code>. What if You want to apply entire row definition for several indices ?
You may repeat <code>.newRow()</code> invokation as many times as required, but there is better option.
You can use row index predicate as follows:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">atIndex { gt(0) and lt(100) } newRow { <i class="conum" data-value="1"></i><b>(1)</b>
    cell { expression = RowCellExpression { &quot;index : ${it.rowIndex.getIndex()}&quot; } } <i class="conum" data-value="2"></i><b>(2)</b>
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>We start the row line with method <code>atIndex { &#8230;&#8203; }</code> which takes row index predicate <code>gt(0) and lt(100)</code>. It literally says: 'Apply this row definition to all indices between index 0 and index 100'. Last 'keyword' sounds: <code>newRow</code> and delivers row definition from within curly braces.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>This line represents definition of a row which is about to be created for each matching index. It contains single cell with runtime expression evaluated at context rendering time.</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>There is also alternative notation used to achieve the same result:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">newRow({ gt(0) and lt(100) }) {
    cell { expression = RowCellExpression { &quot;index : ${it.rowIndex.getIndex()}&quot; } }
}</code></pre>
</div>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_extension_points">Extension points.</h2>
<div class="sectionbody">
<div class="paragraph">
<p>I have put lots of effort to make <strong>Tabulate</strong> extensible. Currently, it is possible to:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>add user defined attributes,</p>
</li>
<li>
<p>add custom renderers for already defined attribute,</p>
</li>
<li>
<p>implement table export operations from scratch (e.g. html table, cli table, mock renderer for testing),</p>
</li>
<li>
<p>extend DSL type-safe builder APIS on all possible level.</p>
</li>
</ul>
</div>
<div class="sect2">
<h3 id="_implementing_new_table_export_operations">Implementing new table export operations.</h3>
<div class="paragraph">
<p>In order to support new tabular file format you have to extend <code>ExportOperationsConfiguringFactory&lt;C, T, O&gt;</code> where:</p>
</div>
<div class="ulist">
<ul>
<li>
<p><code>C</code> stands for rendering context - which is usually wrapper around 3rd party api like Apache POI,</p>
</li>
<li>
<p><code>T</code> stands for object class representing element of exported collection,</p>
</li>
<li>
<p><code>O</code> stands for type of result of operation (e.g. <code>OutputStream</code> for Apache POI)</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>As long as tabulate uses java ServiceLoader infrastructure, You need to create file <code>resource/META-INF/io.github.voytech.tabulate.template.spi.ExportOperationsProvider</code>, and put fully qualified class name of your custom factory in the first line. <strong>This step is required by a template in order to resolve your extension at run-time</strong>.</p>
</div>
<div class="paragraph">
<p>Basic CSV implementation looks like this:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin"><i class="conum" data-value="1"></i><b>(1)</b>
open class CsvRenderingContext: RenderingContext {
    private lateinit var bufferedWriter: BufferedWriter
    private val line = StringBuilder()

    fun doBind(output: OutputStream) {
        bufferedWriter = output.bufferedWriter()
    }

    fun startRow() {
        line.clear()
    }

    private fun AttributedCell.getSeparatorCharacter(): String =
        attributes?.get(CellSeparatorCharacterAttribute::class.java)?.separator ?: &quot;,&quot;

    fun &lt;T&gt; endRow(context: AttributedRowWithCells&lt;T&gt;) {
        val lastIndex = context.rowCellValues.size - 1
        context.rowCellValues.values.forEachIndexed { index, cell -&gt;
            line.append(cell.value.value.toString())
            if (index &lt; lastIndex) line.append(cell.getSeparatorCharacter())
        }
        bufferedWriter.write(line.toString())
        bufferedWriter.newLine()
    }

    fun finish() {
        bufferedWriter.close()
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>CsvRenderingContext</code> implements <code>RenderingContext</code> marker interface and provides logic and state responsible for generating table in selected format. It is a common denominator used as argument of all export operation methods in order to share rendering state and allow interaction with it.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class CsvOutputStreamOutputBinding : OutputStreamOutputBinding&lt;CsvRenderingContext&gt;() {

    override fun onBind(renderingContext: CsvRenderingContext, output: OutputStream) { <i class="conum" data-value="1"></i><b>(1)</b>
        renderingContext.doBind(output)
    }

    override fun flush(output: OutputStream) { <i class="conum" data-value="2"></i><b>(2)</b>
        renderingContext.finish()
        output.close()
    }
}</code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>The <code>.onBind</code> method wires particular rendering context instance with actual output representation (in this particular case it is an OutputStream). Method will be invoked internally by <code>TabulationTemplate</code> as soon as both: output and rendering context instances are available.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>The <code>.flush</code> dumps in-memory rendering context representation into output.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre>class CsvExportOperationsFactory: ExportOperationsProvider&lt;CsvRenderingContext&gt; {

    override fun getContextClass(): Class&lt;CsvRenderingContext&gt; = CsvRenderingContext::class.java <i class="conum" data-value="1"></i><b>(1)</b>

    override fun createRenderingContext() = CsvRenderingContext()  <i class="conum" data-value="2"></i><b>(2)</b>

    override fun supportsFormat(): TabulationFormat = format("csv") <i class="conum" data-value="3"></i><b>(3)</b>

    <i class="conum" data-value="4"></i><b>(4)</b>
    override fun createExportOperations(): AttributedContextExportOperations&lt;CsvRenderingContext&gt; = object :  AttributedContextExportOperations&lt;CsvRenderingContext&gt; {

        override fun beginRow(renderingContext: CsvRenderingContext, context: AttributedRow) {
            renderingContext.startRow()
        }

        override fun renderRowCell(renderingContext: CsvRenderingContext, context: AttributedCell) { }

        override fun &lt;T&gt; endRow(renderingContext: CsvRenderingContext, context: AttributedRowWithCells&lt;T&gt;) {
            renderingContext.endRow(context)
        }
    }

    <i class="conum" data-value="5"></i><b>(5)</b>
    override fun createOutputBindings(): List&lt;OutputBinding&lt;CsvRenderingContext, *&gt;&gt; = listOf(CsvOutputStreamOutputBinding())

}</pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>1</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>2</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>3</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>4</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>5</td>
</tr>
</table>
</div>
<div class="paragraph">
<p>If target tabular format supports styles, You may add support for rendering built-in attributes as follow:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class ExampleExportOperationsConfiguringFactory&lt;T&gt; : ExportOperationsConfiguringFactory&lt;T, SomeRenderingContext&gt;() {

  ..
  override fun getAttributeOperationsFactory(renderingContext: SomeRenderingContext): AttributeRenderOperationsFactory&lt;T&gt; =
      StandardAttributeRenderOperationsFactory(renderingContext, object: StandardAttributeRenderOperationsProvider&lt;ApachePoiExcelFacade,T&gt;{
          override fun createTemplateFileRenderer(renderingContext: ApachePoiExcelFacade): TableAttributeRenderOperation&lt;TemplateFileAttribute&gt; =
            TemplateFileAttributeRenderOperation(renderingContext)

          override fun createColumnWidthRenderer(renderingContext: ApachePoiExcelFacade): ColumnAttributeRenderOperation&lt;ColumnWidthAttribute&gt; =
            ColumnWidthAttributeRenderOperation(renderingContext)

          override fun createRowHeightRenderer(renderingContext: ApachePoiExcelFacade): RowAttributeRenderOperation&lt;T, RowHeightAttribute&gt; =
            RowHeightAttributeRenderOperation(renderingContext)

          override fun createCellTextStyleRenderer(renderingContext: ApachePoiExcelFacade): CellAttributeRenderOperation&lt;CellTextStylesAttribute&gt; =
            CellTextStylesAttributeRenderOperation(renderingContext)

          override fun createCellBordersRenderer(renderingContext: ApachePoiExcelFacade): CellAttributeRenderOperation&lt;CellBordersAttribute&gt; =
            CellBordersAttributeRenderOperation(renderingContext)

          override fun createCellAlignmentRenderer(renderingContext: ApachePoiExcelFacade): CellAttributeRenderOperation&lt;CellAlignmentAttribute&gt; =
            CellAlignmentAttributeRenderOperation(renderingContext)

          override fun createCellBackgroundRenderer(renderingContext: ApachePoiExcelFacade): CellAttributeRenderOperation&lt;CellBackgroundAttribute&gt; =
            CellBackgroundAttributeRenderOperation(renderingContext)
      })
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>Factory class <code>StandardAttributeRenderOperationsFactory</code> exposes API which assumes specific standard library attributes.
If your file format allow additional attributes which are not present in standard library (tabulate-core), you may use <code>AttributeRenderOperationsFactory</code> interface directly, or fill additional constructor properties on <code>StandardAttributeRenderOperationsFactory</code> as below:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class ExampleExportOperationsConfiguringFactory&lt;T&gt; : ExportOperationsConfiguringFactory&lt;T,SomeRenderingContext&gt;() {

  ...
  override fun getAttributeOperationsFactory(renderingContext: SomeRenderingContext): AttributeRenderOperationsFactory&lt;T&gt; =
      StandardAttributeRenderOperationsFactory(renderingContext, object: StandardAttributeRenderOperationsProvider&lt;SomeRenderingContext,T&gt;{
          override fun createTemplateFileRenderer(renderingContext: SomeRenderingContext): TableAttributeRenderOperation&lt;TemplateFileAttribute&gt; = TemplateFileAttributeRenderOperation(renderingContext)
      },
        additionalCellAttributeRenderers = setOf( .. )
        additionalTableAttributeRenderers = setOf( .. )
      )
}</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_registering_new_attribute_types_for_existing_export_operations">Registering new attribute types for existing export operations.</h3>
<div class="paragraph">
<p>It is possible that you have requirements which cannot be achieved with standard set of attributes, and your code is in different compilation unit than specific table export operation implementation. Assume You want to use existing Apache POI excel table exporter, but there is lack of certain attribute support. In such situation - You can still register attribute by implementing another service provider interface - <code>AttributeRenderOperationsProvider</code>:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">class CustomAttributeRendersOperationsProvider&lt;T&gt; : AttributeRenderOperationsProvider&lt;T,ApachePoiExcelFacade&gt; {

    override fun getContextClass() = ApachePoiExcelFacade::class.java

    override fun getAttributeOperationsFactory(creationContext: ApachePoiExcelFacade): AttributeRenderOperationsFactory&lt;T&gt; {
        return object : AttributeRenderOperationsFactory&lt;T&gt; {
            override fun createCellAttributeRenderOperations(): Set&lt;CellAttributeRenderOperation&lt;out CellAttributeAlias&gt;&gt; =
                setOf(MarkerCellAttributeRenderOperation(creationContext))
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>After creating factory - You need to implement particular attribute together with DSL API extension function and attribute render operation to instruct 3rd party Apache Poi API on how to proceed.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">data class MarkerCellAttribute(val text: String) : CellAttribute&lt;MarkerCellAttribute&gt;() {

    class Builder(var text: String = &quot;&quot;) : CellAttributeBuilder&lt;MarkerCellAttribute&gt; {
        override fun build(): MarkerCellAttribute = MarkerCellAttribute(text)
    }
}

class SimpleMarkerCellAttributeRenderOperation(poi: ApachePoiExcelFacade) :
    AdaptingCellAttributeRenderOperation&lt;ApachePoiExcelFacade, SimpleTestCellAttribute&gt;(poi) {

    override fun attributeType(): Class&lt;out MarkerCellAttribute&gt; = MarkerCellAttribute::class.java

    override fun renderAttribute(context: RowCellContext, attribute: MarkerCellAttribute) {
        with(adaptee.assertCell(
            context.getTableId(),
            context.rowIndex,
            context.columnIndex
        )) {
            this.setCellValue(&quot;${this.stringCellValue} [ ${attribute.label} ]&quot;)
        }
    }

}

fun &lt;T&gt; CellLevelAttributesBuilderApi&lt;T&gt;.label(block: MarkerCellAttribute.Builder.() -&gt; Unit) =
    attribute(MarkerCellAttribute.Builder().apply(block))</code></pre>
</div>
</div>
<div class="paragraph">
<p>Finally, You need to create file <code>resource/META-INF/io.github.voytech.tabulate.template.spi.AttributeRenderOperationsProvider</code>, and put fully qualified class name of our factory in it.</p>
</div>
</div>
<div class="sect2">
<h3 id="_extending_table_dsl_api">Extending Table DSL API</h3>
<div class="paragraph">
<p>In the last section You saw how to define custom user attributes. The last step involves creating extension function on specific DSL attribute API. As DSL builder class name suggests (<code>CellLevelAttributesBuilderApi&lt;T&gt;</code>) this builder is part of a Cell DSL API only , which means that it won&#8217;t be possible to add this attribute on row, column and table. You can leverage this behaviour for restricting say 'mounting points' of specific attributes. In order to enable cell attribute on all levels You will need to add more extension functions:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">fun &lt;T&gt; ColumnLevelAttributesBuilderApi&lt;T&gt;.label(block: MarkerCellAttribute.Builder.() -&gt; Unit) =
    attribute(MarkerCellAttribute.Builder().apply(block).build())
fun &lt;T&gt; RowLevelAttributesBuilderApi&lt;T&gt;.label(block: MarkerCellAttribute.Builder.() -&gt; Unit) =
  attribute(MarkerCellAttribute.Builder().apply(block).build())
fun &lt;T&gt; TableLevelAttributesBuilderApi&lt;T&gt;.label(block: MarkerCellAttribute.Builder.() -&gt; Unit) =
  attribute(MarkerCellAttribute.Builder().apply(block).build())</code></pre>
</div>
</div>
<div class="paragraph">
<p>Now You can call <code>label</code> on all DSL API levels in <code>attributes</code> scope like:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">productList.tabulate(&quot;file.xlsx&quot;) {
    name = &quot;Table id&quot;
    attributes {
      label { text = &quot;TABLE&quot; }
    }
    columns {
        column(&quot;nr&quot;) {
            attributes { label { text = &quot;COLUMN&quot; } }
            ..
        }
    }
    rows {
        row {
           attributes { label { text = &quot;ROW&quot; } }
           cell(&quot;nr&quot;) {
              value = &quot;Nr.:&quot;
              attributes {
                attributes { label { text = &quot;CELL&quot; } }
              }
           }
            ..
        }
    }
}</code></pre>
</div>
</div>
<div class="paragraph">
<p>The result of above configuration will be as such:
- In the first row, cell at a column with id "nr" will end with <code>[ CELL ]</code>, and rest of cells will end with <code>[ ROW ]</code>,
- Remaining cells (starting from second row) in a column with id "nr" will end with <code>[ COLUMN ]</code>,
- All remaining cells will end with <code>[ TABLE ]</code>.</p>
</div>
<div style="page-break-after: always;"></div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_other_features">Other features</h2>
<div class="sectionbody">
<div class="sect2">
<h3 id="_java_interop_fluent_builders_java_api">Java interop - fluent builders Java API.</h3>
<div class="paragraph">
<p>Old-fashioned Java fluent builder API is also supported. It is needless to say it looks much less attractive:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="java">Table&lt;Employee&gt; employeeTable = Table.&lt;Employee&gt;builder()
                .attribute(TemplateFileAttribute::builder, builder -&gt; builder.setFileName(<span style="background-color:hsla(0,100%,50%,0.05)"><span style="color:#710">&quot;</span><span style="color:#D20">file.xlsx</span><span style="color:#710">&quot;</span></span>))
                .columns()
                    .column(Employee::getId)
                        .columnType(CellType.NUMERIC)
                        .attribute(ColumnWidthAttribute::builder)
                    .column(Employee::getFirstName)
                        .columnType(CellType.STRING)
                        .attribute(ColumnWidthAttribute::builder)
                    .column(Employee::getLastName)
                        .columnType(CellType.STRING)
                        .attribute(ColumnWidthAttribute::builder)
                .rows()
                    .row()
                        .attribute(RowHeightAttribute::builder, builder -&gt; builder.setPx(<span style="color:#00D">100</span>))
                .build();</code></pre>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_custom_rows">Custom rows.</h3>
<div class="paragraph">
<p>Sometimes, in addition to records from collection - You need to add user defined rows.
Table usually contains a header row or summary footer row.
It is also possible to define interleaving custom rows at specified index or rows that match specific predicate.</p>
</div>
<div class="paragraph">
<p>Row model allows to define custom cell values as well as cell styles and attributes only.
It acts as glue for additional features for existing external source derived rows, or as a factory for standalone custom rows that can be hooked at definition time.</p>
</div>
<div class="paragraph">
<p>Things You can achieve with row model in terms of custom rows includes:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>setting custom cell styles,</p>
</li>
<li>
<p>setting row-level attributes (e.g., row height),</p>
</li>
<li>
<p>defining row and col spans,</p>
</li>
<li>
<p>inserting images,</p>
</li>
<li>
<p>setting cell values of different types.</p>
</li>
</ul>
</div>
</div>
<div class="sect2">
<h3 id="_merging_rows">Merging rows.</h3>
<div class="paragraph">
<p>When multiple <code>Row</code> model definitions are qualified by a predicate, they form a single synthetic row. Following rules regarding row merge applies:
- Row level attributes will be concatenated or merged if are of same type.
- Cell values will be concatenated, or overriden by last cell occurence at given column.
- Cell level attributes will be concatenated, or merged if of same type.
- Two attributes of same type are merged by overriding clashing attribute properties from left to right where on left side stands attribute from higher level (e.g. row level), and on right site stands attribute from lower level (e.g. cell level).</p>
</div>
</div>
<div class="sect2">
<h3 id="_library_of_attributes">Library of attributes.</h3>
<div class="paragraph">
<p>You may need attributes for various reasons - for styling, for formatting or other custom hooks.</p>
</div>
<div class="paragraph">
<p>Currently, with <code>tabulate-core</code> and <code>tabulate-excel</code> modules, you will get following attributes included:</p>
</div>
<div class="sect3">
<h4 id="_table_attributes">Table attributes</h4>
<div class="ulist">
<ul>
<li>
<p><code>FilterAndSortAttribute</code> - enables filtering and sorting of excel table,</p>
</li>
<li>
<p><code>TemplateFileAttribute</code> - allows performing template file interpolation with source data collection of items,</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_column_attributes">Column attributes</h4>
<div class="ulist">
<ul>
<li>
<p><code>ColumnWidthAttribute</code> - sets the width of column (meaning all cells gathered under particular column will have same width),</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_row_attributes">Row attributes</h4>
<div class="ulist">
<ul>
<li>
<p><code>RowHeightAttribute</code> - sets the height of row (meaning all cells gathered within particular row will have same height),</p>
</li>
</ul>
</div>
</div>
<div class="sect3">
<h4 id="_cell_attributes">Cell attributes</h4>
<div class="ulist">
<ul>
<li>
<p><code>CellTextStylesAttribute</code> - allows controlling general, text related style attributes,</p>
</li>
<li>
<p><code>CellBordersAttribute</code> - sets borders on selected cells,</p>
</li>
<li>
<p><code>CellBackgroundAttribute</code> - sets background color and fill,</p>
</li>
<li>
<p><code>CellAlignmentAttribute</code> - sets text vertical and horizontal alignment</p>
</li>
</ul>
</div>
<div class="paragraph">
<p>Typical usage scenario for attributes:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="CodeRay highlight"><code data-lang="kotlin">productsRepository.loadProductsByDate(now()).tabulate(&quot;product_with_styles.xlsx&quot;) {
    name = &quot;Products table&quot;
    columns {
        column(Product::code) {
            attributes(
                width { auto = true },
                text {
                    fontFamily = &quot;Times New Roman&quot;
                    fontColor = Colors.BLACK
                    fontSize = 12
                },
                background { color = Colors.BLUE }
            )
        }
        column(Product::distributionDate) {
            attributes(
                width { auto = true },
                dataFormat { value = &quot;dd.mm.YYYY&quot; }
            )
        }
    }
    rows {
        row {
            attributes(
                text {
                    fontFamily = &quot;Times New Roman&quot;
                    fontColor = Colors.BLACK
                    fontSize = 12
                },
                background { color = Colors.BLUE }
            )
        }
    }
}</code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<div id="footer">
<div id="footer-text">
Last updated 2022-02-18 18:42:29 +0100
</div>
</div>
</body>
</html>